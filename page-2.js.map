{"version":3,"file":"page-2.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/genres-page.js","../src/js/genresMenu.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\n\nconst API_KEY = '5cd3b967f25ca5ea88c6b3955d7951c5';\nconst BASE_URL = 'https://api.themoviedb.org/3';\nconst GENRE_URL = `${BASE_URL}/genre/movie/list`;\nconst MOVIE_URL = `${BASE_URL}/discover/movie`;\n\nexport async function fetchGenres() {\n  try {\n    const response = await axios.get(GENRE_URL, {\n      params: {\n        api_key: API_KEY,\n      },\n    });\n    return response.data.genres;\n  } catch (error) {\n    console.error('Ошибка загрузки жанров:', error);\n    throw error;\n  }\n}\n\nexport async function fetchMoviesByGenre(genreId, page = 1, perPage = 15) {\n  try {\n    const response = await axios.get(MOVIE_URL, {\n      params: {\n        api_key: API_KEY,\n        with_genres: genreId,\n        page,\n      },\n    });\n    return response.data.results;\n  } catch (error) {\n    console.error('Ошибка загрузки фильмов:', error);\n    throw error;\n  }\n}\n","'use strict';\n\nimport { handleMovieClick } from '../genres-page';\n\nexport function renderGenres(genres, container) {\n  container.innerHTML = '';\n  genres.forEach(genre => {\n    const button = document.createElement('button');\n    button.className = 'genres-list-button';\n    button.textContent = genre.name;\n    button.dataset.genreId = genre.id;\n    container.appendChild(button);\n  });\n}\n\nexport function renderMovies(movies, container) {\n  if (movies.length === 0) {\n    container.innerHTML = '<p>No movies found.</p>';\n    return;\n  }\n\n  movies.forEach(movie => {\n    const movieElement = document.createElement('li');\n    movieElement.className = 'movies-list-item';\n    movieElement.innerHTML = `\n      <img src=\"https://image.tmdb.org/t/p/w200${movie.poster_path}\" alt=\"${movie.title}\" class=\"movies-item-img\" width=\"234\" height=\"351\">\n      <h3 class=\"movies-item-title\">${movie.title}</h3>\n    `;\n    container.insertAdjacentElement('beforeend', movieElement);\n\n    const movieItems = document.querySelectorAll('.movies-list-item');\n    movieItems.forEach((item, index) => {\n      item.addEventListener('click', () => handleMovieClick(movies[index]));\n    });\n  });\n}\n","'use strict';\n\nimport './css/genres-page.css';\nimport { fetchGenres, fetchMoviesByGenre } from './js/pixabay-api.js';\nimport { renderGenres, renderMovies } from './js/render-function.js';\nimport 'loaders.css';\n\nconst genresContainer = document.querySelector('.genresContainer');\nconst moviesContainer = document.querySelector('.moviesContainer');\nconst button = document.getElementById('load-btn');\nconst loader = document.querySelector('.loader-container');\nconst modal = document.querySelector('.modal');\nconst modalCloseBtn = document.querySelector('.modal-close-btn');\nconst modalInfo = document.querySelector('.modal-info');\n\nlet currentPage = 1;\nlet genreId = null;\nlet PER_PAGE = 15;\n\nconst urlParams = new URLSearchParams(window.location.search);\n\nfunction getQueryParam(param) {\n  return urlParams.get(param);\n}\n\nfunction getQueryParamName(paramName) {\n  return urlParams.get(paramName);\n}\n\ngenreId = getQueryParam('genre');\nconst genreSelectName = getQueryParamName('genreName');\n\nasync function init() {\n  try {\n    if (genreId) {\n      loader.style.display = 'flex';\n      const moviesSelect = await fetchMoviesByGenre(\n        genreId,\n        currentPage,\n        PER_PAGE\n      );\n      renderMovies(moviesSelect, moviesContainer);\n      const buttonSelect = document.querySelector('.dropdown-button');\n      buttonSelect.textContent = genreSelectName;\n      button.classList.replace('load-more-hidden', 'btn');\n    }\n\n    const genres = await fetchGenres();\n    renderGenres(genres, genresContainer);\n\n    genresContainer.addEventListener('click', async event => {\n      if (event.target.classList.contains('genres-list-button')) {\n        const allGenresButtons = document.querySelectorAll(\n          '.genres-list-button'\n        );\n        allGenresButtons.forEach(button =>\n          button.classList.remove('genres-activated')\n        );\n\n        window.scrollTo({\n          top: 0,\n          behavior: 'smooth',\n        });\n\n        event.target.classList.add('genres-activated');\n\n        genreId = event.target.dataset.genreId;\n        currentPage = 1;\n\n        button.classList.replace('load-more-hidden', 'btn');\n\n        moviesContainer.innerHTML = '';\n        try {\n          loader.style.display = 'flex';\n\n          const movies = await fetchMoviesByGenre(\n            genreId,\n            currentPage,\n            PER_PAGE\n          );\n          renderMovies(movies, moviesContainer);\n        } catch (error) {\n          console.error('Ошибка при загрузке фильмов:', error);\n        } finally {\n          loader.style.display = 'none';\n        }\n      }\n    });\n  } catch (error) {\n    console.log(error.message);\n    errorMessage.classList.replace('error-hidden', 'error-message');\n  } finally {\n    loader.style.display = 'none';\n  }\n}\n\ninit();\n\nbutton.addEventListener('click', handleLoad);\nmodalCloseBtn.addEventListener('click', closeModal);\n\nasync function handleLoad() {\n  if (!genreId) return;\n\n  button.classList.replace('btn', 'load-more-hidden');\n  currentPage += 1;\n\n  try {\n    loader.style.display = 'block';\n\n    const movies = await fetchMoviesByGenre(genreId, currentPage, PER_PAGE);\n    renderMovies(movies, moviesContainer);\n\n    const movieItem = document.querySelector('.movies-list-item');\n    const itemHeight = movieItem.getBoundingClientRect().height;\n\n    window.scrollBy({\n      left: 0,\n      top: itemHeight,\n      behavior: 'smooth',\n    });\n    button.classList.replace('load-more-hidden', 'btn');\n  } catch (error) {\n    console.log(error.message);\n    errorMessage.classList.replace('error-hidden', 'error-message');\n  } finally {\n    button.disabled = false;\n    loader.style.display = 'none';\n  }\n}\n\nexport function handleMovieClick(movie) {\n  const { title, overview, poster_path, release_date, vote_average } = movie;\n\n  modalInfo.innerHTML = `\n    <img src=\"https://image.tmdb.org/t/p/w500${poster_path}\" alt=\"${title}\" width=\"300\" class=\"modal-img\">\n    <div class=\"modal-wrap\">\n    <h2 class=\"modal-title\">${title}</h2>\n    <p class=\"modal-text\">Release Date: <span class=\"modal-text-span\">${release_date}</span></p>\n    <p class=\"modal-text\">Rating: <span class=\"modal-text-span\">${vote_average}</span></p>\n    <p class=\"modal-text\">Overview: <span class=\"modal-text-span\">${overview}</span></p>\n    </div>\n  `;\n\n  modal.classList.remove('hidden');\n}\n\nfunction closeModal() {\n  modal.classList.add('hidden');\n}\n\nmodal.addEventListener('click', event => {\n  if (event.target === modal) {\n    closeModal();\n  }\n});\n","'use strict';\n\nconst dropdown = document.querySelector('.dropdown');\nconst dropdownButton = document.querySelector('.dropdown-button');\nconst dropdownContent = document.querySelector('.genresContainer');\nconst genres = document.querySelectorAll('.genres-list-button');\n\ndropdown.addEventListener('mouseover', function () {\n  dropdownContent.style.display = 'flex';\n});\n\ndropdown.addEventListener('mouseleave', function () {\n  dropdownContent.style.display = 'none';\n});\n\ndocument.addEventListener('click', function (event) {\n  const isClickInside = dropdown.contains(event.target);\n  if (!isClickInside) {\n    dropdownContent.style.display = 'none';\n  }\n});\n\ndropdownContent.addEventListener('click', function (event) {\n  if (event.target && event.target.classList.contains('genres-list-button')) {\n    dropdownButton.textContent = event.target.textContent;\n    dropdownContent.style.display = 'none';\n  }\n});\n"],"names":["API_KEY","BASE_URL","GENRE_URL","MOVIE_URL","fetchGenres","axios","error","fetchMoviesByGenre","genreId","page","perPage","renderGenres","genres","container","genre","button","renderMovies","movies","movie","movieElement","item","index","handleMovieClick","genresContainer","moviesContainer","loader","modal","modalCloseBtn","modalInfo","currentPage","PER_PAGE","urlParams","getQueryParam","param","getQueryParamName","paramName","genreSelectName","init","moviesSelect","buttonSelect","event","handleLoad","closeModal","itemHeight","title","overview","poster_path","release_date","vote_average","dropdown","dropdownButton","dropdownContent"],"mappings":"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"}