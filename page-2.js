import"./assets/top-link-CI3MJDcL.js";import{a as v}from"./assets/vendor-C0Nsn3Ff.js";const L="5cd3b967f25ca5ea88c6b3955d7951c5",w="https://api.themoviedb.org/3",C=`${w}/genre/movie/list`,q=`${w}/discover/movie`;async function x(){try{return(await v.get(C,{params:{api_key:L}})).data.genres}catch(e){throw console.error("Ошибка загрузки жанров:",e),e}}async function u(e,n=1,o=15){try{return(await v.get(q,{params:{api_key:L,with_genres:e,page:n}})).data.results}catch(t){throw console.error("Ошибка загрузки фильмов:",t),t}}function k(e,n){n.innerHTML="",e.forEach(o=>{const t=document.createElement("button");t.className="genres-list-button",t.textContent=o.name,t.dataset.genreId=o.id,n.appendChild(t)})}function p(e,n){if(e.length===0){n.innerHTML="<p>No movies found.</p>";return}e.forEach(o=>{const t=document.createElement("li");t.className="movies-list-item",t.innerHTML=`
      <img src="https://image.tmdb.org/t/p/w200${o.poster_path}" alt="${o.title}" class="movies-item-img" width="234" height="351">
      <h3 class="movies-item-title">${o.title}</h3>
    `,n.insertAdjacentElement("beforeend",t),document.querySelectorAll(".movies-list-item").forEach((m,S)=>{m.addEventListener("click",()=>A(e[S]))})})}const f=document.querySelector(".genresContainer"),i=document.querySelector(".moviesContainer"),a=document.getElementById("load-btn"),r=document.querySelector(".loader-container"),d=document.querySelector(".modal"),I=document.querySelector(".modal-close-btn"),M=document.querySelector(".modal-info");let c=1,s=null,g=15;const b=new URLSearchParams(window.location.search);function _(e){return b.get(e)}function $(e){return b.get(e)}s=_("genre");const B=$("genreName");async function P(){try{if(s){r.style.display="flex";const n=await u(s,c,g);p(n,i);const o=document.querySelector(".dropdown-button");o.textContent=B,a.classList.replace("load-more-hidden","btn")}const e=await x();k(e,f),f.addEventListener("click",async n=>{if(n.target.classList.contains("genres-list-button")){document.querySelectorAll(".genres-list-button").forEach(t=>t.classList.remove("genres-activated")),window.scrollTo({top:0,behavior:"smooth"}),n.target.classList.add("genres-activated"),s=n.target.dataset.genreId,c=1,a.classList.replace("load-more-hidden","btn"),i.innerHTML="";try{r.style.display="flex";const t=await u(s,c,g);p(t,i)}catch(t){console.error("Ошибка при загрузке фильмов:",t)}finally{r.style.display="none"}}})}catch(e){console.log(e.message),errorMessage.classList.replace("error-hidden","error-message")}finally{r.style.display="none"}}P();a.addEventListener("click",R);I.addEventListener("click",E);async function R(){if(s){a.classList.replace("btn","load-more-hidden"),c+=1;try{r.style.display="block";const e=await u(s,c,g);p(e,i);const o=document.querySelector(".movies-list-item").getBoundingClientRect().height;window.scrollBy({left:0,top:o,behavior:"smooth"}),a.classList.replace("load-more-hidden","btn")}catch(e){console.log(e.message),errorMessage.classList.replace("error-hidden","error-message")}finally{a.disabled=!1,r.style.display="none"}}}function A(e){const{title:n,overview:o,poster_path:t,release_date:h,vote_average:m}=e;M.innerHTML=`
    <img src="https://image.tmdb.org/t/p/w500${t}" alt="${n}" width="300" class="modal-img">
    <div class="modal-wrap">
    <h2 class="modal-title">${n}</h2>
    <p class="modal-text">Release Date: <span class="modal-text-span">${h}</span></p>
    <p class="modal-text">Rating: <span class="modal-text-span">${m}</span></p>
    <p class="modal-text">Overview: <span class="modal-text-span">${o}</span></p>
    </div>
  `,d.classList.remove("hidden")}function E(){d.classList.add("hidden")}d.addEventListener("click",e=>{e.target===d&&E()});const y=document.querySelector(".dropdown"),G=document.querySelector(".dropdown-button"),l=document.querySelector(".genresContainer");document.querySelectorAll(".genres-list-button");y.addEventListener("mouseover",function(){l.style.display="flex"});y.addEventListener("mouseleave",function(){l.style.display="none"});document.addEventListener("click",function(e){y.contains(e.target)||(l.style.display="none")});l.addEventListener("click",function(e){e.target&&e.target.classList.contains("genres-list-button")&&(G.textContent=e.target.textContent,l.style.display="none")});
//# sourceMappingURL=page-2.js.map
