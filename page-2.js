import"./assets/lang-toggle-A8p9mm5l.js";import{a as f}from"./assets/vendor-C0Nsn3Ff.js";const v="5cd3b967f25ca5ea88c6b3955d7951c5",w="https://api.themoviedb.org/3",M=`${w}/genre/movie/list`,k=`${w}/discover/movie`;async function L(){try{return(await f.get(M,{params:{api_key:v,language:window.currentLanguage||"en"}})).data.genres}catch(e){throw console.error("Ошибка загрузки жанров:",e),e}}async function d(e,t=1,o=15){try{return(await f.get(k,{params:{api_key:v,with_genres:e,language:window.currentLanguage||"en",page:t}})).data.results}catch(n){throw console.error("Ошибка загрузки фильмов:",n),n}}function b(e,t){t.innerHTML="",e.forEach(o=>{const n=document.createElement("button");n.className="genres-list-button",n.textContent=o.name,n.dataset.genreId=o.id,t.appendChild(n)})}function m(e,t){if(e.length===0){t.innerHTML="<p>No movies found.</p>";return}e.forEach(o=>{const n=document.createElement("li");n.className="movies-list-item",n.innerHTML=`
      <img src="https://image.tmdb.org/t/p/w200${o.poster_path}" alt="${o.title}" class="movies-item-img" width="234" height="351">
      <h3 class="movies-item-title">${o.title}</h3>
    `,t.insertAdjacentElement("beforeend",n),n.addEventListener("click",()=>G(o))})}const p=document.querySelector(".genresContainer"),l=document.querySelector(".moviesContainer"),i=document.getElementById("load-btn"),r=document.querySelector(".loader-container"),u=document.querySelector(".modal"),q=document.querySelector(".modal-close-btn"),_=document.querySelector(".modal-info");let a=1,s=null,g=15,h=[];const E=new URLSearchParams(window.location.search);function I(e){return E.get(e)}function $(e){return E.get(e)}s=I("genre");const B=$("genreName");async function P(){try{if(s){r.style.display="flex";const t=await d(s,a,g);m(t,l);const o=document.querySelector(".dropdown-button");o.textContent=B,i.classList.replace("load-more-hidden","btn")}const e=await L();b(e,p),p.addEventListener("click",async t=>{if(t.target.classList.contains("genres-list-button")){document.querySelectorAll(".genres-list-button").forEach(n=>n.classList.remove("genres-activated")),window.scrollTo({top:0,behavior:"smooth"}),t.target.classList.add("genres-activated"),s=t.target.dataset.genreId,a=1,i.classList.replace("load-more-hidden","btn"),l.innerHTML="";try{r.style.display="flex";const n=await d(s,a,g);m(n,l)}catch(n){console.error("Ошибка при загрузке фильмов:",n)}finally{r.style.display="none"}}})}catch(e){console.log(e.message),errorMessage.classList.replace("error-hidden","error-message")}finally{r.style.display="none"}}P();i.addEventListener("click",R);q.addEventListener("click",S);async function R(){if(s){i.classList.replace("btn","load-more-hidden"),a+=1;try{r.style.display="block";const e=await d(s,a,g);h=[...h,...e],m(e,l);const o=document.querySelector(".movies-list-item").getBoundingClientRect().height;window.scrollBy({left:0,top:o,behavior:"smooth"}),i.classList.replace("load-more-hidden","btn")}catch(e){console.log(e.message),errorMessage.classList.replace("error-hidden","error-message")}finally{i.disabled=!1,r.style.display="none"}}}function G(e){const{title:t,overview:o,poster_path:n,release_date:C,vote_average:x}=e;_.innerHTML=`
    <img src="https://image.tmdb.org/t/p/w500${n}" alt="${t}" width="300" class="modal-img">
    <div class="modal-wrap">
    <h2 class="modal-title">${t}</h2>
    <p class="modal-text">Release Date: <span class="modal-text-span">${C}</span></p>
    <p class="modal-text">Rating: <span class="modal-text-span">${x}</span></p>
    <p class="modal-text">Overview: <span class="modal-text-span">${o}</span></p>
    </div>
  `,u.classList.remove("hidden")}function S(){u.classList.add("hidden")}u.addEventListener("click",e=>{e.target===u&&S()});window.addEventListener("languageChange",async()=>{l.innerHTML="",a=1;let e=[],t=[];try{e=await L(),b(e,p),s&&(t=await d(s,a,g),m(t,l))}catch(o){console.error("Error loading movies on language change:",o.message)}});const y=document.querySelector(".dropdown"),H=document.querySelector(".dropdown-button"),c=document.querySelector(".genresContainer");document.querySelectorAll(".genres-list-button");y.addEventListener("mouseover",function(){c.style.display="flex"});y.addEventListener("mouseleave",function(){c.style.display="none"});document.addEventListener("click",function(e){y.contains(e.target)||(c.style.display="none")});c.addEventListener("click",function(e){e.target&&e.target.classList.contains("genres-list-button")&&(H.textContent=e.target.textContent,c.style.display="none")});
//# sourceMappingURL=page-2.js.map
