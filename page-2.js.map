{"version":3,"file":"page-2.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/genres-page.js","../src/js/genresMenu.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\n\nconst API_KEY = '5cd3b967f25ca5ea88c6b3955d7951c5';\nconst BASE_URL = 'https://api.themoviedb.org/3';\nconst GENRE_URL = `${BASE_URL}/genre/movie/list`;\nconst MOVIE_URL = `${BASE_URL}/discover/movie`;\n\nexport async function fetchGenres() {\n  try {\n    const response = await axios.get(GENRE_URL, {\n      params: {\n        api_key: API_KEY,\n      },\n    });\n    return response.data.genres;\n  } catch (error) {\n    console.error('Ошибка загрузки жанров:', error);\n    throw error;\n  }\n}\n\nexport async function fetchMoviesByGenre(genreId, page = 1, perPage = 15) {\n  try {\n    const response = await axios.get(MOVIE_URL, {\n      params: {\n        api_key: API_KEY,\n        with_genres: genreId,\n        page,\n      },\n    });\n    return response.data.results;\n  } catch (error) {\n    console.error('Ошибка загрузки фильмов:', error);\n    throw error;\n  }\n}\n","'use strict';\n\nexport function renderGenres(genres, container) {\n  container.innerHTML = '';\n  genres.forEach(genre => {\n    const button = document.createElement('button');\n    button.className = 'genres-list-button';\n    button.textContent = genre.name;\n    button.dataset.genreId = genre.id;\n    container.appendChild(button);\n  });\n}\n\nexport function renderMovies(movies, container) {\n  if (movies.length === 0) {\n    container.innerHTML = '<p>Фильмы не найдены.</p>';\n    return;\n  }\n\n  movies.forEach(movie => {\n    const movieElement = document.createElement('li');\n    movieElement.className = 'movies-list-item';\n    movieElement.innerHTML = `\n      <img src=\"https://image.tmdb.org/t/p/w200${movie.poster_path}\" alt=\"${movie.title}\" class=\"movies-item-img\" width=\"234\" height=\"351\">\n      <h3 class=\"movies-item-title\">${movie.title}</h3>\n    `;\n    container.insertAdjacentElement('beforeend', movieElement);\n  });\n}\n","'use strict';\n\nimport './css/genres-page.css';\nimport { fetchGenres, fetchMoviesByGenre } from './js/pixabay-api.js';\nimport { renderGenres, renderMovies } from './js/render-function.js';\nimport 'loaders.css';\n\nconst genresContainer = document.querySelector('.genresContainer');\nconst moviesContainer = document.querySelector('.moviesContainer');\nconst button = document.getElementById('load-btn');\nconst loader = document.querySelector('.loader-container');\n\nlet currentPage = 1;\nlet genreId = null;\nlet PER_PAGE = 15;\n\nconst urlParams = new URLSearchParams(window.location.search);\n\nfunction getQueryParam(param) {\n  return urlParams.get(param);\n}\n\nfunction getQueryParamName(paramName) {\n  return urlParams.get(paramName);\n}\n\ngenreId = getQueryParam('genre');\nconst genreSelectName = getQueryParamName('genreName');\n\nasync function init() {\n  try {\n    if (genreId) {\n      loader.style.display = 'flex';\n      const moviesSelect = await fetchMoviesByGenre(\n        genreId,\n        currentPage,\n        PER_PAGE\n      );\n      renderMovies(moviesSelect, moviesContainer);\n      const buttonSelect = document.querySelector('.dropdown-button');\n      buttonSelect.textContent = genreSelectName;\n      button.classList.replace('load-more-hidden', 'btn');\n    }\n\n    const genres = await fetchGenres();\n    renderGenres(genres, genresContainer);\n\n    genresContainer.addEventListener('click', async event => {\n      if (event.target.classList.contains('genres-list-button')) {\n        const allGenresButtons = document.querySelectorAll(\n          '.genres-list-button'\n        );\n        allGenresButtons.forEach(button =>\n          button.classList.remove('genres-activated')\n        );\n\n        window.scrollTo({\n          top: 0,\n          behavior: 'smooth',\n        });\n\n        event.target.classList.add('genres-activated');\n\n        genreId = event.target.dataset.genreId;\n        currentPage = 1;\n\n        button.classList.replace('load-more-hidden', 'btn');\n\n        moviesContainer.innerHTML = '';\n        try {\n          loader.style.display = 'flex';\n\n          const movies = await fetchMoviesByGenre(\n            genreId,\n            currentPage,\n            PER_PAGE\n          );\n          renderMovies(movies, moviesContainer);\n        } catch (error) {\n          console.error('Ошибка при загрузке фильмов:', error);\n        } finally {\n          loader.style.display = 'none';\n        }\n      }\n    });\n  } catch (error) {\n    console.log(error.message);\n    errorMessage.classList.replace('error-hidden', 'error-message');\n  } finally {\n    loader.style.display = 'none';\n  }\n}\n\ninit();\n\nbutton.addEventListener('click', handleLoad);\n\nasync function handleLoad() {\n  if (!genreId) return;\n\n  button.classList.replace('btn', 'load-more-hidden');\n  currentPage += 1;\n\n  try {\n    loader.style.display = 'block';\n\n    const movies = await fetchMoviesByGenre(genreId, currentPage, PER_PAGE);\n    renderMovies(movies, moviesContainer);\n\n    const movieItem = document.querySelector('.movies-list-item');\n    const itemHeight = movieItem.getBoundingClientRect().height;\n\n    window.scrollBy({\n      left: 0,\n      top: itemHeight,\n      behavior: 'smooth',\n    });\n    button.classList.replace('load-more-hidden', 'btn');\n  } catch (error) {\n    console.log(error.message);\n    errorMessage.classList.replace('error-hidden', 'error-message');\n  } finally {\n    button.disabled = false;\n    loader.style.display = 'none';\n  }\n}\n","'use strict';\n\nconst dropdown = document.querySelector('.dropdown');\nconst dropdownButton = document.querySelector('.dropdown-button');\nconst dropdownContent = document.querySelector('.genresContainer');\nconst genres = document.querySelectorAll('.genres-list-button');\n\ndropdown.addEventListener('mouseover', function () {\n  dropdownContent.style.display = 'flex';\n});\n\ndropdown.addEventListener('mouseleave', function () {\n  dropdownContent.style.display = 'none';\n});\n\ndocument.addEventListener('click', function (event) {\n  const isClickInside = dropdown.contains(event.target);\n  if (!isClickInside) {\n    dropdownContent.style.display = 'none';\n  }\n});\n\ndropdownContent.addEventListener('click', function (event) {\n  if (event.target && event.target.classList.contains('genres-list-button')) {\n    dropdownButton.textContent = event.target.textContent;\n    dropdownContent.style.display = 'none';\n  }\n});\n"],"names":["API_KEY","BASE_URL","GENRE_URL","MOVIE_URL","fetchGenres","axios","error","fetchMoviesByGenre","genreId","page","perPage","renderGenres","genres","container","genre","button","renderMovies","movies","movie","movieElement","genresContainer","moviesContainer","loader","currentPage","PER_PAGE","urlParams","getQueryParam","param","getQueryParamName","paramName","genreSelectName","init","moviesSelect","buttonSelect","event","handleLoad","itemHeight","dropdown","dropdownButton","dropdownContent"],"mappings":"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"}