{"version":3,"file":"page-2.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/genres-page.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\n\nconst API_KEY = '5cd3b967f25ca5ea88c6b3955d7951c5';\nconst BASE_URL = 'https://api.themoviedb.org/3';\nconst GENRE_URL = `${BASE_URL}/genre/movie/list`;\nconst MOVIE_URL = `${BASE_URL}/discover/movie`;\n\nexport async function fetchGenres() {\n  try {\n    const response = await axios.get(GENRE_URL, {\n      params: {\n        api_key: API_KEY,\n      },\n    });\n    return response.data.genres;\n  } catch (error) {\n    console.error('Ошибка загрузки жанров:', error);\n    throw error;\n  }\n}\n\nexport async function fetchMoviesByGenre(genreId, page = 1, perPage = 15) {\n  try {\n    const response = await axios.get(MOVIE_URL, {\n      params: {\n        api_key: API_KEY,\n        with_genres: genreId,\n        page,\n      },\n    });\n    return response.data.results;\n  } catch (error) {\n    console.error('Ошибка загрузки фильмов:', error);\n    throw error;\n  }\n}\n","'use strict';\n\nexport function renderGenres(genres, container) {\n  container.innerHTML = '';\n  genres.forEach(genre => {\n    const button = document.createElement('button');\n    button.className = 'genres-list-button';\n    button.textContent = genre.name;\n    button.dataset.genreId = genre.id;\n    container.appendChild(button);\n  });\n}\n\nexport function renderMovies(movies, container) {\n  if (movies.length === 0) {\n    container.innerHTML = '<p>Фильмы не найдены.</p>';\n    return;\n  }\n\n  movies.forEach(movie => {\n    const movieElement = document.createElement('li');\n    movieElement.className = 'movies-list-item';\n    movieElement.innerHTML = `\n      <img src=\"https://image.tmdb.org/t/p/w200${movie.poster_path}\" alt=\"${movie.title}\" class=\"movies-item-img\">\n      <h3 class=\"movies-item-title\">${movie.title}</h3>\n    `;\n    container.insertAdjacentElement('beforeend', movieElement);\n  });\n}\n","'use strict';\n\nimport './css/genres-page.css';\nimport { fetchGenres, fetchMoviesByGenre } from './js/pixabay-api.js';\nimport { renderGenres, renderMovies } from './js/render-function.js';\n\nconst genresContainer = document.querySelector('.genresContainer');\nconst moviesContainer = document.querySelector('.moviesContainer');\nconst button = document.getElementById('load-btn');\n\nlet currentPage = 1;\nlet genreId = null;\nlet PER_PAGE = 15;\n\nasync function init() {\n  try {\n    const genres = await fetchGenres();\n    renderGenres(genres, genresContainer);\n\n    genresContainer.addEventListener('click', async event => {\n      if (event.target.classList.contains('genres-list-button')) {\n        const allGenresButtons = document.querySelectorAll(\n          '.genres-list-button'\n        );\n        allGenresButtons.forEach(button =>\n          button.classList.remove('genres-activated')\n        );\n\n        window.scrollTo({\n          top: 0,\n          behavior: 'smooth',\n        });\n\n        event.target.classList.add('genres-activated');\n\n        genreId = event.target.dataset.genreId;\n        currentPage = 1;\n\n        button.classList.replace('load-more-hidden', 'btn');\n\n        moviesContainer.innerHTML = '';\n        try {\n          const movies = await fetchMoviesByGenre(\n            genreId,\n            currentPage,\n            PER_PAGE\n          );\n          renderMovies(movies, moviesContainer);\n        } catch (error) {\n          console.error('Ошибка при загрузке фильмов:', error);\n        }\n      }\n    });\n  } catch (error) {\n    console.error('Ошибка инициализации приложения:', error);\n  }\n}\n\ninit();\n\nbutton.addEventListener('click', handleLoad);\n\nasync function handleLoad() {\n  if (!genreId) return;\n\n  button.classList.replace('btn', 'load-more-hidden');\n  currentPage += 1;\n\n  try {\n    const movies = await fetchMoviesByGenre(genreId, currentPage, PER_PAGE);\n    renderMovies(movies, moviesContainer);\n\n    const movieItem = document.querySelector('.movies-list-item');\n    const itemHeight = movieItem.getBoundingClientRect().height;\n\n    window.scrollBy({\n      left: 0,\n      top: itemHeight,\n      behavior: 'smooth',\n    });\n    button.classList.replace('load-more-hidden', 'btn');\n  } catch (error) {\n    console.log('Ошибка при загрузке следующих фильмов:', error);\n  } finally {\n    button.disabled = false;\n  }\n}\n"],"names":["API_KEY","BASE_URL","GENRE_URL","MOVIE_URL","fetchGenres","axios","error","fetchMoviesByGenre","genreId","page","perPage","renderGenres","genres","container","genre","button","renderMovies","movies","movie","movieElement","genresContainer","moviesContainer","currentPage","PER_PAGE","init","event","handleLoad","itemHeight"],"mappings":"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"}